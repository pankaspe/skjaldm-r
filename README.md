# Skjaldmær boilerplate for Svelte Kit

Build a Svelte kit project + supabase + tailwind, powered by [`create-svelte`](https://github.com/sveltejs/kit/tree/master/packages/create-svelte).

## Initial settings

### Step 1
Register on [supabase](https://supabase.com/) and create new project, enter your preferred name. Go to SQL editor and paste this schema
```bash
-- Create a table for public profiles
create table profiles (
  id uuid references auth.users not null primary key,
  updated_at timestamp with time zone,
  username text unique,
  full_name text,
  avatar_url text,
  website text,

  constraint username_length check (char_length(username) >= 3)
);

-- Set up Row Level Security (RLS)
-- See https://supabase.com/docs/guides/auth/row-level-security for more details.
alter table profiles
  enable row level security;

create policy "Public profiles are viewable by everyone." on profiles
  for select using (true);

create policy "Users can insert their own profile." on profiles
  for insert with check (auth.uid() = id);

create policy "Users can update own profile." on profiles
  for update using (auth.uid() = id);

-- This trigger automatically creates a profile entry when a new user signs up via Supabase Auth.
-- See https://supabase.com/docs/guides/auth/managing-user-data#using-triggers for more details.
create or replace function public.handle_new_user()
returns trigger as $$
begin
  insert into public.profiles (id, full_name, avatar_url)
  values (new.id, new.raw_user_meta_data->>'full_name', new.raw_user_meta_data->>'avatar_url');
  return new;
end;
$$ language plpgsql security definer;
create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();

-- Set up Storage!
insert into storage.buckets (id, name)
  values ('avatars', 'avatars');

create policy "Avatar images are publicly accessible." on storage.objects
  for select using (bucket_id = 'avatars');

create policy "Anyone can upload an avatar." on storage.objects
  for insert with check (bucket_id = 'avatars');

create policy "Anyone can update their own avatar." on storage.objects
  for update using (auth.uid() = owner) with check (bucket_id = 'avatars');



-- create category
create table category (
    id bigint generated by default as identity primary key,
    profile_id uuid references profiles,
    name text,
    description text,
    value bigint generated by default as identity,
    created_at timestamp with time zone
);

-- RLS for category
alter table category
  enable row level security;

create policy "Public category are viewable by everyone." on category
  for select using (true);

create policy "Users can insert their own category." on category
  for insert with check (auth.uid() = profile_id);

create policy "Users can update own category." on category
  for update using (auth.uid() = profile_id);

create policy "User can delete own category" on category
  for delete using (auth.uid() = profile_id);



-- create item
create table item (
  id bigint generated by default as identity primary key,
  profile_id uuid references profiles,
  category_id bigint references category,
  title text,
  slug text,
  description text,
  created_at timestamp with time zone,
  updated_at timestamp with time zone
);

-- RLS for item
alter table item
  enable row level security;

create policy "Public item are viewable by everyone." on item
  for select using (true);

create policy "Users can insert their own item." on item
  for insert with check (auth.uid() = profile_id);

create policy "Users can update own item." on item
  for update using (auth.uid() = profile_id);

create policy "User can delete own item" on item
  for delete using (auth.uid() = profile_id);
```

### Step 2
Clone this repository, `cd` in, change name on `package.json` and then `npm run install`.
Go to supabase dashboard -> API and copy **Project URL** and **anon API key**
create a new `.env` file and paste the keys
```
PUBLIC_SUPABASE_URL="YOUR-PROJECT-URL"
PUBLIC_SUPABASE_ANON_KEY="YOUR-ANON-KEY"
```

### Step 3
Go to supabase Auth -> users and add new user, **Add user -> Create New User** fill email and password and check **auto confirm user**
run `npm run dev` open your browser and point *localhost:5173* 

Enjoy the Skjaldmær boilerplate


## note
is still under dev